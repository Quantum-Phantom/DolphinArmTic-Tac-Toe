#line 1 "C:\\Users\\youth\\Documents\\C_Homework\\tic-tac-toe\\README.md"
# 机械臂井字棋游戏 - Arduino程序

## 项目概述

本项目实现了使用Arduino控制机械臂与人类进行3×3井字棋游戏的功能。机械臂作为先手（X），人类玩家作为后手（O），通过串口监视器输入下棋位置。

## 硬件要求

- Arduino 开发板（如 Arduino Uno、Mega 等）
- 4个舵机（水平旋转、左臂、右臂、夹爪）
- 2个摇杆模块（带按钮）
- 机械臂结构
- 连接线

## 舵机连接

| 舵机 | 引脚 |
|------|------|
| 左臂舵机 | 8 |
| 右臂舵机 | 9 |
| 水平旋转舵机 | 10 |
| 夹爪舵机 | 11 |

## 摇杆连接

| 摇杆 | X轴 | Y轴 | 按钮 |
|------|-----|-----|------|
| 摇杆1 | A0 | A1 | 2 |
| 摇杆2 | A2 | A3 | 3 |

## 构建方法

## 可调整参数

在代码开头的 `BoardConfig` 结构体中可以调整以下参数：

```cpp
struct BoardConfig {
    // 棋盘位置（单位：毫米）
    float centerX = 150.0;    // 棋盘中心的X坐标
    float centerY = 200.0;    // 棋盘中心的Y坐标  
    float centerZ = 0.0;      // 棋盘表面的Z坐标
    
    // 格子间距（单位：毫米）
    float cellSpacing = 30.0;  // 每个格子的间距
    
    // 机械臂下子高度
    float moveHeight = 80.0;   // 下子时夹爪离棋盘的高度
    float hoverHeight = 120.0; // 悬停高度（移动时）
    
    // 下子后停留时间（毫秒）
    unsigned int dwellTime = 2000;
    
    // 舵机角度偏移（用于微调）
    int horizontalOffset = 0;  // 水平舵机偏移
    int leftOffset = 0;        // 左臂舵机偏移
    int rightOffset = 0;       // 右臂舵机偏移
} boardConfig;
```

### 参数说明

#### 棋盘位置参数
- `centerX`, `centerY`, `centerZ`: 棋盘中心点的空间坐标（单位：毫米）
  - 需要根据实际安装位置测量调整
  - 建议使用尺子精确测量

#### 格子间距参数
- `cellSpacing`: 相邻格子中心的距离（单位：毫米）
  - 标准3×3棋盘通常每个格子边长30-50mm
  - 根据实际棋盘尺寸调整

#### 高度参数
- `moveHeight`: 下子时夹爪距离棋盘的高度
  - 如果夹爪上安装了印章，需要确保印章能接触到棋盘
  - 建议初始值80mm，根据实际情况微调
  
- `hoverHeight`: 移动时的悬停高度
  - 需要高于棋盘上已有的棋子
  - 建议120-150mm

#### 时间参数
- `dwellTime`: 下子后停留时间（毫秒）
  - 用于确保印章清晰地盖在棋盘上
  - 建议2000-3000ms

#### 舵机偏移参数
- `horizontalOffset`, `leftOffset`, `rightOffset`: 舵机角度偏移
  - 用于微调机械臂的精度
  - 如果机械臂下子位置有偏差，可以通过这些参数校正

## 使用方法

### 1. 开始游戏

1. 上传程序到Arduino
2. 打开串口监视器（波特率9600）
3. **同时长按两个摇杆按钮约1.5秒**
4. 看到"游戏开始！"提示后，游戏正式开始

### 2. 游戏流程

- **机械臂先手（X）**：程序会自动计算最佳位置并执行下子
- **人类后手（O）**：在串口监视器中输入位置

### 3. 人类玩家输入格式

在串口监视器中输入：**行号 列号**

- 行号和列号都是 **0-2** 之间的数字
- 用空格分隔
- 例如：
  - `1 1` - 中间格子
  - `0 0` - 左上角
  - `2 1` - 下方中间格子

**棋盘坐标示意图：**
```
[0,0] [0,1] [0,2]
[1,0] [1,1] [1,2]  
[2,0] [2,1] [2,2]
```

### 4. 游戏结束

游戏会在以下情况下结束：
- 一方连成一条直线（获胜）
- 棋盘填满但无人获胜（平局）

游戏结束后，**同时长按两个按钮**可以开始新游戏。

## 机械臂下子动作流程

1. 
2. 
3. 

## 机械臂AI策略

机械臂采用以下策略选择下子位置：

1. **检查是否能赢** - 如果有机会连成三子，立即执行
2. **检查是否需要阻止对手** - 如果对手即将获胜，必须阻止
3. **优先占中心** - 中心位置最有利
4. **优先占角落** - 角落位置次之
5. **占边** - 边缘位置
6. **找空位** - 实在没办法时的选择

## 调试技巧

### 1. 校准棋盘位置

如果机械臂下子位置不准确：

1. 在 `loop()` 函数中，游戏开始前可以用摇杆手动控制机械臂
2. 将夹爪移动到每个格子的实际中心位置
3. 记录此时的坐标，更新 `centerX`, `centerY` 参数

### 2. 检查舵机方向

如果某个轴运动方向相反，可以：
- 调整对应舵机的角度偏移参数
- 或者修改 `inverseOperation()` 函数中的符号

### 3. 串口监视器调试

程序会通过串口输出以下信息：
- 游戏状态
- 机械臂的移动目标
- 当前棋盘状态
- 错误提示

## 安全注意事项

1. **确保机械臂工作范围内没有障碍物**
2. **首次测试时降低移动速度**（增大 `stepDelay` 参数）
3. **确保电源能提供足够电流**（4个舵机同时工作时电流较大）
4. **建议在机械臂周围设置防护栏**

## 扩展功能

### 添加声音提示
可以在关键步骤添加蜂鸣器提示音：
```cpp
tone(pin, frequency, duration);
```

### 添加LED指示灯
可以用LED显示游戏状态：
- 绿色：游戏中
- 红色：游戏结束
- 蓝色：等待人类输入

### 改进AI算法
当前的AI算法比较简单，可以考虑：
- 实现Minimax算法获得完美策略
- 添加随机性使游戏更有趣
- 实现不同难度级别

## 故障排除

### 问题1：机械臂不动
- 检查舵机连接线
- 检查电源供电是否充足
- 检查串口监视器是否有错误信息

### 问题2：下子位置不准确
- 重新校准棋盘中心坐标
- 调整格子间距参数
- 检查机械臂结构是否松动

### 问题3：手势无法识别
- 检查摇杆按钮连接
- 确保长按时间足够（1.5秒）
- 检查按钮是否有接触不良

### 问题4：串口输入无响应
- 确保输入格式正确（行号 列号）
- 检查串口监视器波特率设置（9600）
- 确保在正确的回合输入

## 许可证

本项目仅供学习和研究使用。

## 联系方式

如有问题或建议，欢迎反馈！
